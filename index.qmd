---
title: "Visualização de Dados"
format:
  html:
    toc: false
    echo: false
    keep-hidden: true
    
---

```{ojs}

geojs_bahia = FileAttachment("geojs_bahia.json")

html`<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>`

html`<div id="map" style="height: 500px;"></div>`

viewof map = {
  const mapDiv = document.getElementById('map');
  
  const map = L.map(mapDiv).setView([-12.9714, -38.5014], 10);

  L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20
  }).addTo(map);

  // Adiciona um GeoJSON com os limites dos municípios da Bahia
  fetch('geojs_bahia.json') 
    .then(response => response.json())
    .then(data => {
      L.geoJSON(data, {
        style: {
        color: 'green', 
        weight: 1 
      },
         onEachFeature: function (feature, layer) {
        const popupContent = `
          <b>Município:</b> ${feature.properties.name}<br>
          <b>id:</b> ${feature.properties.id}<br>
           
          <button onclick="window.location.href = 'http://localhost:4200/municipio/?id=' + ${feature.properties.id}+ '&ano=2022' ;">Ir para ${feature.properties.name}</button>
        `;
        
        layer.bindPopup(popupContent);
      }
      }).addTo(map);
    });

  return mapDiv;
}
```
